# Data Engineering Mini Project üöÄ

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–π end-to-end data pipeline, –≤–∫–ª—é—á–∞—é—â–∏–π:

- **Kafka** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö.
- **PostgreSQL** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (OLTP/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞).
- **MinIO** ‚Äî S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ/–±—ç–∫–∞–ø—ã).
- **Apache Flink** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- **Apache Airflow** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ETL –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö.
- **Producer** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞–≤–æ–∫ (–∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
- **Consumer** ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ ¬´—Å—ã—Ä—ã—Ö¬ª —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞–≤–æ–∫ –≤ Postgres.
- **Flink Jobs** ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫.

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
    subgraph PRODUCER["Producer"]
        P1["bets_producer.py"]
    end

    subgraph KAFKA["Kafka"]
        T1["bets topic"]
    end

    subgraph FLINK["Flink Cluster"]
        J1["job_top_games.py"]
        J2["job_avg_bet.py"]
        J3["job_bet_status.py"]
        J4["job_active_users.py"]
    end

    subgraph CONSUMER["Consumer"]
        C1["all_bets_consumer.py"]
    end

    subgraph STORAGE["Data Storage"]
        DB[(PostgreSQL<br/>bets table)]
        S3[(MinIO / S3)]
    end

    subgraph AIRFLOW["Airflow"]
        DAG1["bets_exporter DAG"]
    end

    P1 --> T1
    T1 --> C1 --> DB
    T1 --> J1 --> DB
    T1 --> J2 --> DB
    T1 --> J3 --> DB
    T1 --> J4 --> DB
    DB --> DAG1 --> S3
```

- **producer** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è —Å—Ç–∞–≤–æ–∫ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ Kafka (`bets` topic). –¢–æ–ø–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏.
- **Flink** —á–∏—Ç–∞–µ—Ç –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Kafka, –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∏—à–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Postgres.
- **consumer** (`all_bets_consumer.py`) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü—É `bets` –≤ Postgres –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞.
- **Postgres** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ `bets`.
- **MinIO** (S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
- **Airflow** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≥—Ä—É–∂–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `bets` (–≥–¥–µ `exported=false`) –≤ MinIO –≤ —Ñ–æ—Ä–º–∞—Ç–µ **Parquet**, –ø–æ–º–µ—á–∞—è –∏—Ö –∫–∞–∫ `exported=true`.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ .env                    # –§–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îÇ
‚îú‚îÄ‚îÄ airflow/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ entrypoint.sh       # –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Airflow
‚îÇ   ‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ all_bets_exporter_dag.py
‚îÇ   ‚îî‚îÄ‚îÄ exporters/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ all_bets_exporter.py
‚îÇ
‚îú‚îÄ‚îÄ consumer/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ consumers/
‚îÇ       ‚îú‚îÄ‚îÄ all_bets_consumer.py  # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ bets2
‚îÇ       ‚îî‚îÄ‚îÄ top_games_consumer.py # (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

‚îú‚îÄ‚îÄ flink/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ flink-conf.yml
‚îÇ   ‚îú‚îÄ‚îÄ artifacts/          # JAR —Ñ–∞–π–ª—ã –¥–ª—è Flink –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ jobs/
‚îÇ       ‚îú‚îÄ‚îÄ job_active_users.py
‚îÇ       ‚îú‚îÄ‚îÄ job_avg_bet.py
‚îÇ       ‚îú‚îÄ‚îÄ job_bet_status.py
‚îÇ       ‚îî‚îÄ‚îÄ job_top_games.py
‚îÇ
‚îú‚îÄ‚îÄ postgres-init/
‚îÇ   ‚îî‚îÄ‚îÄ init.sql            # SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
‚îÇ
‚îî‚îÄ‚îÄ producer/
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îî‚îÄ‚îÄ bets_producer.py    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞–≤–æ–∫
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å [Docker](https://www.docker.com/get-started) –∏ [Docker Compose](https://docs.docker.com/compose/install/)
2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å FERNET_KEY –¥–ª—è Airflow (–¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π –≤ –ë–î):
   ```bash
   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
   ```
   –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–ª—é—á - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è —Ñ–∞–π–ª–∞ `.env`
3. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# PostgreSQL
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin
POSTGRES_DB=bets_db
POSTGRES_HOST=postgres

# Kafka
KAFKA_BROKER=kafka:9092
TOPIC_NAME=bets

# MinIO/S3
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
S3_BUCKET=bets
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin

# Airflow
AIRFLOW__CORE__FERNET_KEY=your_fernet_key_here  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —à–∞–≥–µ 2
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW_ADMIN_USERNAME=admin
AIRFLOW_ADMIN_PASSWORD=admin
AIRFLOW_ADMIN_EMAIL=admin@example.com

# PgAdmin
PGADMIN_DEFAULT_EMAIL=admin@example.com
PGADMIN_DEFAULT_PASSWORD=admin
```

### 1. –ü–æ–¥–Ω—è—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

```bash
docker-compose up -d
```

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. Kafka –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Ç–æ–ø–∏–∫ `bets` –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏ (–±–ª–∞–≥–æ–¥–∞—Ä—è `KAFKA_AUTO_CREATE_TOPICS_ENABLE: "true"`).

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
docker-compose ps
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç (Status: Up).

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Flink jobs

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å Flink jobs:

```bash
docker exec -it jobmanager /opt/flink/bin/flink run -py /opt/flink/jobs/job_top_games.py
docker exec -it jobmanager /opt/flink/bin/flink run -py /opt/flink/jobs/job_avg_bet.py
docker exec -it jobmanager /opt/flink/bin/flink run -py /opt/flink/jobs/job_bet_status.py
docker exec -it jobmanager /opt/flink/bin/flink run -py /opt/flink/jobs/job_active_users.py
```

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å jobs –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ Flink UI: http://localhost:8081

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

#### –í PostgreSQL:

```bash
docker exec -it postgres psql -U ${POSTGRES_USER} -d ${POSTGRES_DB}
```

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```sql
-- –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–æ–∫
SELECT * FROM bets LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–≥—Ä–∞–º (Flink job)
SELECT * FROM bet_stats LIMIT 10;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏
SELECT COUNT(*) FROM bets WHERE exported = true;
SELECT COUNT(*) FROM bets WHERE exported = false;
```

#### –í Airflow:

- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080
- –í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ `.env` —Ñ–∞–π–ª–∞
- –ù–∞–π–¥–∏—Ç–µ DAG `bets_exporter` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
- DAG –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

#### –í MinIO:

- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:9001
- –í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ `.env` —Ñ–∞–π–ª–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∫–µ—Ç `bets` (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —ç–∫—Å–ø–æ—Ä—Ç–µ)
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `raw/YYYY-MM-DD/part-HHMMSS.parquet`

#### –í Kowl (Kafka UI):

- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:9002
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–æ–ø–∏–∫ `bets` –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –¥–∞–Ω–Ω—ã–µ

### Flink Jobs (—Ä–µ–∞–ª-—Ç–∞–π–º –∞–≥—Ä–µ–≥–∞—Ü–∏—è):

- üéÆ **–¢–æ–ø –∏–≥—Ä** –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å—Ç–∞–≤–æ–∫ (`job_top_games.py`)
- üí∞ **–°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏** (`job_avg_bet.py`)
- üìà **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–≤–æ–∫ –ø–æ —Å—Ç–∞—Ç—É—Å—É** (`job_bet_status.py`)
- üë§ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (`job_active_users.py`)

### –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö:

- **PostgreSQL (`bets` —Ç–∞–±–ª–∏—Ü–∞)**: –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–æ–∫ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, —Å–æ–±—ã—Ç–∏—è—Ö –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **MinIO/S3**: –ê—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Parquet, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–∞–º (`raw/YYYY-MM-DD/`)

### –ü—Ä–æ—Ü–µ—Å—Å —ç–∫—Å–ø–æ—Ä—Ç–∞:

1. **Consumer** –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ Kafka –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `bets` —Å —Ñ–ª–∞–≥–æ–º `exported=false`
2. **Airflow DAG** (`bets_exporter`) –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç:
   - –í—ã–±–∏—Ä–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≥–¥–µ `exported=false`
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Parquet —Ñ–æ—Ä–º–∞—Ç
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ MinIO
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–ª–∞–≥ `exported=true`

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.10+** ‚Äî Producer, Consumer, Flink jobs, Airflow DAGs
- **Apache Kafka 4.0.1** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ —Å–æ–±—ã—Ç–∏–π
- **PostgreSQL 15** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (OLTP)
- **Apache Flink 1.17.2** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **Apache Airflow 2.10.3** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ETL –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á
- **MinIO** ‚Äî S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∞—Ä—Ö–∏–≤–æ–≤
- **Docker + Docker Compose** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- **Kowl** ‚Äî UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ Kafka —Ç–æ–ø–∏–∫–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- **PgAdmin** ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü–æ—Ä—Ç |
|-----------|-----------|------|
| Producer | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞–≤–æ–∫ | - |
| Kafka | –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π | 9092 |
| Consumer | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL | - |
| Flink JobManager | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Flink jobs | 8081 |
| Flink TaskManager | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Flink jobs | - |
| PostgreSQL | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | 5432 |
| MinIO | S3-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ | 9000 (API), 9001 (UI) |
| Airflow | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ETL | 8080 |
| Kowl | Kafka UI | 9002 |
| PgAdmin | PostgreSQL UI | 5050 |

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–∞–±–ª–∏—Ü–∞ `bets`** —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
2. **Kafka —Ç–æ–ø–∏–∫–∏** —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏
3. **MinIO –±–∞–∫–µ—Ç** —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Airflow DAG –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —ç–∫—Å–ø–æ—Ä—Ç–µ
4. **Airflow** —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `AIRFLOW__CORE__FERNET_KEY` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
5. –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–∫–∞–∑–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `.env`

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Airflow –Ω–µ –≤–∏–¥–∏—Ç DAG
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs airflow`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DAG —Ñ–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã (–æ—Å–æ–±–µ–Ω–Ω–æ –º–æ–¥—É–ª—å `exporters`)

### MinIO –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `S3_ACCESS_KEY` –∏ `S3_SECRET_KEY` –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å `MINIO_ROOT_USER` –∏ `MINIO_ROOT_PASSWORD`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `S3_ENDPOINT` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `http://minio:9000`

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ PostgreSQL
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PostgreSQL –∑–∞–ø—É—â–µ–Ω: `docker-compose ps postgres`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs postgres`

---
